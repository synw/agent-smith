# Tools routing agent

The tools routing agents take a query and returns the raw result of a tool call. A subagent will use
it's tools and run inference using the tools results. A tools routing agent will just run the appropriate
tool and return the raw tool call result. Usage: to centralize tool calls and keep the parent agent's
context window and tools number minimal.

Example: a simple filesystem tools routing agent:

```yaml
# agents/filesystem.yml
tool:
    description: Filesystem tool. It can list directories content, read and write files.
    arguments:
        prompt: 
            description: "The prompt query: to list a given dir, read or write a file. Example query: directory listing: /path/to/dir. Other example: write to file /path/to file/ this content: `filecontent here`."
description: Filesystem routing agent
prompt: |-
    Call the relevant tool to execute this user query:

    {prompt}
template:
    afterSystem: |-
        
        You are an AI filesystem assistant. You are equiped with tools to operate on the filesystem.
ctx: 32768
model:
    name: qwen4b
    template: chatml-tools
inferParams:
    top_k: 20
    top_p: 0.7
    min_p: 0
    temperature: 0.2
mcp:
  filesystem:
    command: npx
    arguments:
      - "-y"
      - "@modelcontextprotocol/server-filesystem"
      - /path/to/authorized/dir
      - /home/me/agent-smith/packages/agent
    tools:
      - list_directory
      - read_text_file
      - write_file?
```

Important: to declare an agent as a tools routing agent mention the words "routing agent" in the agent's description.

Run `lm update` to register your agent

Use this agent in a parent agent:

```yaml
# agents/myagent.yml
description: An agent
# ...
toolsList:
    - fs
```

Run the agent:

```bash
> cd agent-smith/packages/agent # any path specified in the mcp server arguments
# you can also run lm "some prompt" --mcp filesystem:. to allow the current dir for the filesystem agent
> lm myagent "how many dependencies does the project in the current directory has?"
```

Output:

```
I need to check the current directory to determine how many dependencies the project has. First, I'll list the contents of the current directory to look for files that might contain dependency information (like package.json, requirements.txt, etc.).

⚒️  myagent => filesystem { prompt: 'directory listing: .' }
Secure MCP Filesystem Server running on stdio
Client does not support MCP Roots, using allowed directories set from server args: [ '/home/me/agent-smith/packages/agent' ]
⚒️  filesystem => list_directory { path: '.' }
The project in the current directory has a `package.json` file, which typically contains dependency information for JavaScript/Node.js projects. I'll examine the `package.json` file to determine how many dependencies it has.

⚒️  myagent => filesystem { prompt: 'read file package.json' }
Secure MCP Filesystem Server running on stdio
Client does not support MCP Roots, using allowed directories set from server args: [ '/home/me/agent-smith/packages/agent' ]
⚒️  filesystem => read_text_file { path: 'package.json' }
The project has **3 dependencies** listed in the `package.json` file under the `dependencies` section:

1. `@locallm/api` ^0.7.3  
2. `modprompt` ^0.12.6  
3. `restmix` ^0.6.1  

These are the direct dependencies required for the project to function. Additionally, there are 9 devDependencies, but those are not counted as project dependencies. 

So, the total number of dependencies is **3**.
```


