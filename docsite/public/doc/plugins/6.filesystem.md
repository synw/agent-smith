# Filesystem

![pub package](https://img.shields.io/npm/v/@agent-smith/feat-fs)

Filesystem features

## Install

```bash
npm i -g @agent-smith/feat-fs
```

Add the plugin and it's dependency to your `config.yml` file and run the `conf` command to update the cli.

```yml
plugins:
  - "@agent-smith/feat-fs"
```

```bash
lm conf
```

## Actions

### Directory listing

```bash
lm lsdir path/to/dir
```

This will list the directory files and dirs. Output:

```js
{ files: [file1, file2], dirs: [dir1, dir2]}
```

### Read file

```bash
lm readfile path/to/file.ext
```

Returns the file content.

Alternative command, using the system's `cat` command:

```bash
lm cat path/to/file.ext
```

### Write to file

```bash
lm writetofile "file content here" path/to/file.ext
```

### Get the content of all the files in a directory

```bash
lm dirfiles path/to/dir
```

Output:

```
File: src/file1.ts
'''
console.log("hello")
'''

File: src/interfaces.ts
'''
interface Test {
    a: string;
}

export { Test }
'''
```

## Agent

A filesystem routing agent is available. It has the following tools: local tools:

- *dirfiles*: get all files content in a directory, see above

Mcp tools from [@modelcontextprotocol/server-filesystem](https://github.com/modelcontextprotocol/servers/blob/main/src/filesystem/README.md):

- list_directory
- list_directory_with_sizes
- read_text_file
- read_multiple_files
- search_files
- directory_tree

Default model: *qwen4b*. This agent is a routing agent, it is called from a parent agent as a tool:
it will dispatch tool calls from a query and return the raw result of the tool calls to the parent agent.
To enable the *fsreadagent* in the parent agent:

```yml
description: An example agent
# ...
toolsList:
  - fsreadagent
```

The model will see it as only one tool. Tool doc seen by the parent agent:

```yml
tool:
    description: Filesystem read tool. It can list directories content or tree, read and search for files.
    arguments:
        prompt: 
            description: |-
                The prompt query: to list a given dir, read or search. Example queries: 
                - Directory listing for .
                - Directory listing with files sizes for /path/to/dir
                - Directory tree for ./path/to/dir                
                - Read this file: /path/to/file
                - Read these files: /path/to/file1, /path/to/file2
                - Search for a config.toml file in the current directory
```

Example with Qwen 4b:

```bash
cd agent-smith/packages/cli
lm exampleagent "explain me what the code project in the current directory is doing" --mcp filesystem:.
```

```
⚒️  exagent => fsreadagent { prompt: 'Search for a README.md file in the current directory' }
⚒️  fsreadagent => search_files { path: '.', pattern: 'README.md' }
The code project in the current directory is likely a CLI (Command Line Interface) tool, as indicated by the `README.md` file located at `/home/me/agent-smith/packages/cli/README.md`. 

To understand what the project is doing, I would need to read the contents of the `README.md` file. Let me proceed with reading that file for you. 

I'll now read the `README.md` file. 
⚒️  exagent => fsreadagent {
  prompt: 'Read this file: /home/me/agent-smith/packages/cli/README.md'
}
⚒️  fsreadagent => read_text_file { path: '/home/me/agent-smith/packages/cli/README.md' }
The project in the current directory is **Agent Smith**, a terminal client designed to interact with language models. Here's a breakdown of what it does:

### Purpose
- **A terminal client to use language models** (e.g., for tasks like generating text, analyzing data, or answering questions).

// ...

In summary, **Agent Smith is a powerful CLI tool that allows users to interact with language models via terminal commands, supporting both text-based queries and image-based vision tasks**.
```
